


===== 1_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 1849941456 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date_sub('1998-12-01', interval 79 day)
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+----------------------------------------------+
| id   | select_type | table    | type | possible_keys | key  | key_len | ref  | rows      | filtered | Extra                                        |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+----------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL  | i_l_shipdate  | NULL | NULL    | NULL | 179998372 |    49.95 | Using where; Using temporary; Using filesort |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+----------------------------------------------+
--- Time elapsed ---
298



===== 1_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 1849941456 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date_sub('1998-12-01', interval 79 day)
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+----------------------------------------------+
| id   | select_type | table    | type | possible_keys | key  | key_len | ref  | rows      | filtered | Extra                                        |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+----------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL  | i_l_shipdate  | NULL | NULL    | NULL | 179998372 |    49.95 | Using where; Using temporary; Using filesort |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+----------------------------------------------+
--- Time elapsed ---
314



===== 1_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 1849941456 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date_sub('1998-12-01', interval 79 day)
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+----------------------------------------------+
| id   | select_type | table    | type | possible_keys | key  | key_len | ref  | rows      | filtered | Extra                                        |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+----------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL  | i_l_shipdate  | NULL | NULL    | NULL | 179998372 |    50.06 | Using where; Using temporary; Using filesort |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+----------------------------------------------+
--- Time elapsed ---
303



===== 2_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 2844875632 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 27
	and p_type like '%STEEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AMERICA'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'AMERICA'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+-------+----------+---------------------------------------------------------------------------+
| id   | select_type        | table    | type   | possible_keys                     | key           | key_len | ref                       | rows  | filtered | Extra                                                                     |
+------+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+-------+----------+---------------------------------------------------------------------------+
|    1 | PRIMARY            | region   | ALL    | PRIMARY                           | NULL          | NULL    | NULL                      |     5 |   100.00 | Using where; Using temporary; Using filesort                              |
|    1 | PRIMARY            | nation   | ref    | PRIMARY,i_n_regionkey             | i_n_regionkey | 5       | dbt3.region.r_regionkey   |     5 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan        |
|    1 | PRIMARY            | supplier | ref    | PRIMARY,i_s_nationkey             | i_s_nationkey | 5       | dbt3.nation.n_nationkey   | 12000 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey | i_ps_suppkey  | 4       | dbt3.supplier.s_suppkey   |    80 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | part     | eq_ref | PRIMARY                           | PRIMARY       | 4       | dbt3.partsupp.ps_partkey  |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan  |
|    2 | DEPENDENT SUBQUERY | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey | PRIMARY       | 4       | dbt3.part.p_partkey       |     4 |   100.00 |                                                                           |
|    2 | DEPENDENT SUBQUERY | supplier | eq_ref | PRIMARY,i_s_nationkey             | PRIMARY       | 4       | dbt3.partsupp.ps_suppkey  |     1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan         |
|    2 | DEPENDENT SUBQUERY | nation   | eq_ref | PRIMARY,i_n_regionkey             | PRIMARY       | 4       | dbt3.supplier.s_nationkey |     1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan               |
|    2 | DEPENDENT SUBQUERY | region   | ALL    | PRIMARY                           | NULL          | NULL    | NULL                      |     5 |    80.00 | Using where; Using join buffer (incremental, BNL join)                    |
+------+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+-------+----------+---------------------------------------------------------------------------+
--- Time elapsed ---
129



===== 2_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 2844875632 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 27
	and p_type like '%STEEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AMERICA'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'AMERICA'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+-------+----------+---------------------------------------------------------------------------+
| id   | select_type        | table    | type   | possible_keys                     | key           | key_len | ref                       | rows  | filtered | Extra                                                                     |
+------+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+-------+----------+---------------------------------------------------------------------------+
|    1 | PRIMARY            | region   | ALL    | PRIMARY                           | NULL          | NULL    | NULL                      |     5 |   100.00 | Using where; Using temporary; Using filesort                              |
|    1 | PRIMARY            | nation   | ref    | PRIMARY,i_n_regionkey             | i_n_regionkey | 5       | dbt3.region.r_regionkey   |     5 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan        |
|    1 | PRIMARY            | supplier | ref    | PRIMARY,i_s_nationkey             | i_s_nationkey | 5       | dbt3.nation.n_nationkey   | 12000 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey | i_ps_suppkey  | 4       | dbt3.supplier.s_suppkey   |    80 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | part     | eq_ref | PRIMARY                           | PRIMARY       | 4       | dbt3.partsupp.ps_partkey  |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan  |
|    2 | DEPENDENT SUBQUERY | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey | PRIMARY       | 4       | dbt3.part.p_partkey       |     4 |   100.00 |                                                                           |
|    2 | DEPENDENT SUBQUERY | supplier | eq_ref | PRIMARY,i_s_nationkey             | PRIMARY       | 4       | dbt3.partsupp.ps_suppkey  |     1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan         |
|    2 | DEPENDENT SUBQUERY | nation   | eq_ref | PRIMARY,i_n_regionkey             | PRIMARY       | 4       | dbt3.supplier.s_nationkey |     1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan               |
|    2 | DEPENDENT SUBQUERY | region   | ALL    | PRIMARY                           | NULL          | NULL    | NULL                      |     5 |    80.00 | Using where; Using join buffer (incremental, BNL join)                    |
+------+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+-------+----------+---------------------------------------------------------------------------+
--- Time elapsed ---
129



===== 2_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 2844875632 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	s_acctbal,
	s_name,
	n_name,
	p_partkey,
	p_mfgr,
	s_address,
	s_phone,
	s_comment
from
	part,
	supplier,
	partsupp,
	nation,
	region
where
	p_partkey = ps_partkey
	and s_suppkey = ps_suppkey
	and p_size = 27
	and p_type like '%STEEL'
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AMERICA'
	and ps_supplycost = (
		select
			min(ps_supplycost)
		from
			partsupp,
			supplier,
			nation,
			region
		where
			p_partkey = ps_partkey
			and s_suppkey = ps_suppkey
			and s_nationkey = n_nationkey
			and n_regionkey = r_regionkey
			and r_name = 'AMERICA'
	)
order by
	s_acctbal desc,
	n_name,
	s_name,
	p_partkey
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+-------+----------+---------------------------------------------------------------------------+
| id   | select_type        | table    | type   | possible_keys                     | key           | key_len | ref                       | rows  | filtered | Extra                                                                     |
+------+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+-------+----------+---------------------------------------------------------------------------+
|    1 | PRIMARY            | region   | ALL    | PRIMARY                           | NULL          | NULL    | NULL                      |     5 |   100.00 | Using where; Using temporary; Using filesort                              |
|    1 | PRIMARY            | nation   | ref    | PRIMARY,i_n_regionkey             | i_n_regionkey | 5       | dbt3.region.r_regionkey   |     5 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan        |
|    1 | PRIMARY            | supplier | ref    | PRIMARY,i_s_nationkey             | i_s_nationkey | 5       | dbt3.nation.n_nationkey   | 12000 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey | i_ps_suppkey  | 4       | dbt3.supplier.s_suppkey   |    80 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | part     | eq_ref | PRIMARY                           | PRIMARY       | 4       | dbt3.partsupp.ps_partkey  |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan  |
|    2 | DEPENDENT SUBQUERY | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey | PRIMARY       | 4       | dbt3.part.p_partkey       |     4 |   100.00 |                                                                           |
|    2 | DEPENDENT SUBQUERY | supplier | eq_ref | PRIMARY,i_s_nationkey             | PRIMARY       | 4       | dbt3.partsupp.ps_suppkey  |     1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan         |
|    2 | DEPENDENT SUBQUERY | nation   | eq_ref | PRIMARY,i_n_regionkey             | PRIMARY       | 4       | dbt3.supplier.s_nationkey |     1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan               |
|    2 | DEPENDENT SUBQUERY | region   | ALL    | PRIMARY                           | NULL          | NULL    | NULL                      |     5 |    80.00 | Using where; Using join buffer (incremental, BNL join)                    |
+------+--------------------+----------+--------+-----------------------------------+---------------+---------+---------------------------+-------+----------+---------------------------------------------------------------------------+
--- Time elapsed ---
128



===== 3_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 3839809808 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'AUTOMOBILE'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < '1995-03-19'
	and l_shipdate > '1995-03-19'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+---------------------------------------------------------+---------------+---------+------------------------+----------+----------+-----------------------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                           | key           | key_len | ref                    | rows     | filtered | Extra                                                                                   |
+------+-------------+----------+--------+---------------------------------------------------------+---------------+---------+------------------------+----------+----------+-----------------------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | range  | PRIMARY,i_o_orderdate,i_o_custkey                       | i_o_orderdate | 4       | NULL                   | 22514893 |   100.00 | Using index condition; Using where; Rowid-ordered scan; Using temporary; Using filesort |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY                                                 | PRIMARY       | 4       | dbt3.orders.o_custkey  |        1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan                       |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_shipdate,i_l_orderkey,i_l_orderkey_quantity | PRIMARY       | 4       | dbt3.orders.o_orderkey |        3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan                |
+------+-------------+----------+--------+---------------------------------------------------------+---------------+---------+------------------------+----------+----------+-----------------------------------------------------------------------------------------+
--- Time elapsed ---
345



===== 3_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 3839809808 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'AUTOMOBILE'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < '1995-03-19'
	and l_shipdate > '1995-03-19'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+---------------------------------------------------------+---------------+---------+------------------------+----------+----------+-----------------------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                           | key           | key_len | ref                    | rows     | filtered | Extra                                                                                   |
+------+-------------+----------+--------+---------------------------------------------------------+---------------+---------+------------------------+----------+----------+-----------------------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | range  | PRIMARY,i_o_orderdate,i_o_custkey                       | i_o_orderdate | 4       | NULL                   | 22332401 |   100.00 | Using index condition; Using where; Rowid-ordered scan; Using temporary; Using filesort |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY                                                 | PRIMARY       | 4       | dbt3.orders.o_custkey  |        1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan                       |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_shipdate,i_l_orderkey,i_l_orderkey_quantity | PRIMARY       | 4       | dbt3.orders.o_orderkey |        3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan                |
+------+-------------+----------+--------+---------------------------------------------------------+---------------+---------+------------------------+----------+----------+-----------------------------------------------------------------------------------------+
--- Time elapsed ---
349



===== 3_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 3839809808 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_orderkey,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	o_orderdate,
	o_shippriority
from
	customer,
	orders,
	lineitem
where
	c_mktsegment = 'AUTOMOBILE'
	and c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate < '1995-03-19'
	and l_shipdate > '1995-03-19'
group by
	l_orderkey,
	o_orderdate,
	o_shippriority
order by
	revenue desc,
	o_orderdate
LIMIT 10;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+---------------------------------------------------------+---------------+---------+------------------------+----------+----------+-----------------------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                           | key           | key_len | ref                    | rows     | filtered | Extra                                                                                   |
+------+-------------+----------+--------+---------------------------------------------------------+---------------+---------+------------------------+----------+----------+-----------------------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | range  | PRIMARY,i_o_orderdate,i_o_custkey                       | i_o_orderdate | 4       | NULL                   | 22537704 |   100.00 | Using index condition; Using where; Rowid-ordered scan; Using temporary; Using filesort |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY                                                 | PRIMARY       | 4       | dbt3.orders.o_custkey  |        1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan                       |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_shipdate,i_l_orderkey,i_l_orderkey_quantity | PRIMARY       | 4       | dbt3.orders.o_orderkey |        3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan                |
+------+-------------+----------+--------+---------------------------------------------------------+---------------+---------+------------------------+----------+----------+-----------------------------------------------------------------------------------------+
--- Time elapsed ---
340



===== 4_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 539776688 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	o_orderpriority,
	count(*) as order_count
from
	orders
where
	o_orderdate >= date '1997-05-01'
	and o_orderdate < date_add( '1997-05-01', interval 3 month)
	and exists (
		select
			*
		from
			lineitem
		where
			l_orderkey = o_orderkey
			and l_commitdate < l_receiptdate
	)
group by
	o_orderpriority
order by
	o_orderpriority;
COMMIT;

--- Explain result ---
+------+--------------------+----------+-------+--------------------------------------------+---------------+---------+------------------------+---------+----------+-----------------------------------------------------------------------------------------+
| id   | select_type        | table    | type  | possible_keys                              | key           | key_len | ref                    | rows    | filtered | Extra                                                                                   |
+------+--------------------+----------+-------+--------------------------------------------+---------------+---------+------------------------+---------+----------+-----------------------------------------------------------------------------------------+
|    1 | PRIMARY            | orders   | range | i_o_orderdate                              | i_o_orderdate | 4       | NULL                   | 3443440 |   100.00 | Using index condition; Using where; Rowid-ordered scan; Using temporary; Using filesort |
|    2 | DEPENDENT SUBQUERY | lineitem | ref   | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | PRIMARY       | 4       | dbt3.orders.o_orderkey |       3 |   100.00 | Using where                                                                             |
+------+--------------------+----------+-------+--------------------------------------------+---------------+---------+------------------------+---------+----------+-----------------------------------------------------------------------------------------+
--- Time elapsed ---
275



===== 4_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 539776688 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	o_orderpriority,
	count(*) as order_count
from
	orders
where
	o_orderdate >= date '1997-05-01'
	and o_orderdate < date_add( '1997-05-01', interval 3 month)
	and exists (
		select
			*
		from
			lineitem
		where
			l_orderkey = o_orderkey
			and l_commitdate < l_receiptdate
	)
group by
	o_orderpriority
order by
	o_orderpriority;
COMMIT;

--- Explain result ---
+------+--------------------+----------+-------+--------------------------------------------+---------------+---------+------------------------+---------+----------+-----------------------------------------------------------------------------------------+
| id   | select_type        | table    | type  | possible_keys                              | key           | key_len | ref                    | rows    | filtered | Extra                                                                                   |
+------+--------------------+----------+-------+--------------------------------------------+---------------+---------+------------------------+---------+----------+-----------------------------------------------------------------------------------------+
|    1 | PRIMARY            | orders   | range | i_o_orderdate                              | i_o_orderdate | 4       | NULL                   | 3443440 |   100.00 | Using index condition; Using where; Rowid-ordered scan; Using temporary; Using filesort |
|    2 | DEPENDENT SUBQUERY | lineitem | ref   | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | PRIMARY       | 4       | dbt3.orders.o_orderkey |       3 |   100.00 | Using where                                                                             |
+------+--------------------+----------+-------+--------------------------------------------+---------------+---------+------------------------+---------+----------+-----------------------------------------------------------------------------------------+
--- Time elapsed ---
274



===== 4_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 539776688 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	o_orderpriority,
	count(*) as order_count
from
	orders
where
	o_orderdate >= date '1997-05-01'
	and o_orderdate < date_add( '1997-05-01', interval 3 month)
	and exists (
		select
			*
		from
			lineitem
		where
			l_orderkey = o_orderkey
			and l_commitdate < l_receiptdate
	)
group by
	o_orderpriority
order by
	o_orderpriority;
COMMIT;

--- Explain result ---
+------+--------------------+----------+-------+--------------------------------------------+---------------+---------+------------------------+---------+----------+-----------------------------------------------------------------------------------------+
| id   | select_type        | table    | type  | possible_keys                              | key           | key_len | ref                    | rows    | filtered | Extra                                                                                   |
+------+--------------------+----------+-------+--------------------------------------------+---------------+---------+------------------------+---------+----------+-----------------------------------------------------------------------------------------+
|    1 | PRIMARY            | orders   | range | i_o_orderdate                              | i_o_orderdate | 4       | NULL                   | 3443440 |   100.00 | Using index condition; Using where; Rowid-ordered scan; Using temporary; Using filesort |
|    2 | DEPENDENT SUBQUERY | lineitem | ref   | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | PRIMARY       | 4       | dbt3.orders.o_orderkey |       3 |   100.00 | Using where                                                                             |
+------+--------------------+----------+-------+--------------------------------------------+---------------+---------+------------------------+---------+----------+-----------------------------------------------------------------------------------------+
--- Time elapsed ---
273



===== 5_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 1534710864 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AFRICA'
	and o_orderdate >= '1995-01-01'
	and o_orderdate < date_add( '1995-01-01' , interval 1 year)
group by
	n_name
order by
	revenue desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+--------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                          | key     | key_len | ref                       | rows     | filtered | Extra                                                                    |
+------+-------------+----------+--------+--------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | ALL    | PRIMARY,i_o_orderdate,i_o_custkey                      | NULL    | NULL    | NULL                      | 45000000 |    28.58 | Using where; Using temporary; Using filesort                             |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                                  | PRIMARY | 4       | dbt3.orders.o_custkey     |        1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan        |
|    1 | SIMPLE      | nation   | eq_ref | PRIMARY,i_n_regionkey                                  | PRIMARY | 4       | dbt3.customer.c_nationkey |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | PRIMARY | 4       | dbt3.orders.o_orderkey    |        3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | region   | eq_ref | PRIMARY                                                | PRIMARY | 4       | dbt3.nation.n_regionkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | supplier | eq_ref | PRIMARY,i_s_nationkey                                  | PRIMARY | 4       | dbt3.lineitem.l_suppkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
+------+-------------+----------+--------+--------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
--- Time elapsed ---
744



===== 5_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 1534710864 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AFRICA'
	and o_orderdate >= '1995-01-01'
	and o_orderdate < date_add( '1995-01-01' , interval 1 year)
group by
	n_name
order by
	revenue desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+--------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                          | key     | key_len | ref                       | rows     | filtered | Extra                                                                    |
+------+-------------+----------+--------+--------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | ALL    | PRIMARY,i_o_orderdate,i_o_custkey                      | NULL    | NULL    | NULL                      | 45000000 |    28.58 | Using where; Using temporary; Using filesort                             |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                                  | PRIMARY | 4       | dbt3.orders.o_custkey     |        1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan        |
|    1 | SIMPLE      | nation   | eq_ref | PRIMARY,i_n_regionkey                                  | PRIMARY | 4       | dbt3.customer.c_nationkey |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | PRIMARY | 4       | dbt3.orders.o_orderkey    |        3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | region   | eq_ref | PRIMARY                                                | PRIMARY | 4       | dbt3.nation.n_regionkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | supplier | eq_ref | PRIMARY,i_s_nationkey                                  | PRIMARY | 4       | dbt3.lineitem.l_suppkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
+------+-------------+----------+--------+--------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
--- Time elapsed ---
748



===== 5_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 1534710864 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	n_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue
from
	customer,
	orders,
	lineitem,
	supplier,
	nation,
	region
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and l_suppkey = s_suppkey
	and c_nationkey = s_nationkey
	and s_nationkey = n_nationkey
	and n_regionkey = r_regionkey
	and r_name = 'AFRICA'
	and o_orderdate >= '1995-01-01'
	and o_orderdate < date_add( '1995-01-01' , interval 1 year)
group by
	n_name
order by
	revenue desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+--------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                          | key     | key_len | ref                       | rows     | filtered | Extra                                                                    |
+------+-------------+----------+--------+--------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | ALL    | PRIMARY,i_o_orderdate,i_o_custkey                      | NULL    | NULL    | NULL                      | 45000000 |    28.58 | Using where; Using temporary; Using filesort                             |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                                  | PRIMARY | 4       | dbt3.orders.o_custkey     |        1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan        |
|    1 | SIMPLE      | nation   | eq_ref | PRIMARY,i_n_regionkey                                  | PRIMARY | 4       | dbt3.customer.c_nationkey |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | PRIMARY | 4       | dbt3.orders.o_orderkey    |        3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | region   | eq_ref | PRIMARY                                                | PRIMARY | 4       | dbt3.nation.n_regionkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | supplier | eq_ref | PRIMARY,i_s_nationkey                                  | PRIMARY | 4       | dbt3.lineitem.l_suppkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
+------+-------------+----------+--------+--------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
--- Time elapsed ---
724



===== 6_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 2529645040 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= '1993-01-01'
	and l_shipdate < date_add( '1993-01-01' , interval 1 year)
	and l_discount between 0.08 - 0.01 and 0.08 + 0.01
	and l_quantity < 25;
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+-------------+
| id   | select_type | table    | type | possible_keys | key  | key_len | ref  | rows      | filtered | Extra       |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+-------------+
|    1 | SIMPLE      | lineitem | ALL  | i_l_shipdate  | NULL | NULL    | NULL | 179998372 |    30.09 | Using where |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+-------------+
--- Time elapsed ---
174



===== 6_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 2529645040 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= '1993-01-01'
	and l_shipdate < date_add( '1993-01-01' , interval 1 year)
	and l_discount between 0.08 - 0.01 and 0.08 + 0.01
	and l_quantity < 25;
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+-------------+
| id   | select_type | table    | type | possible_keys | key  | key_len | ref  | rows      | filtered | Extra       |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+-------------+
|    1 | SIMPLE      | lineitem | ALL  | i_l_shipdate  | NULL | NULL    | NULL | 179998372 |    30.09 | Using where |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+-------------+
--- Time elapsed ---
173



===== 6_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 2529645040 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice * l_discount) as revenue
from
	lineitem
where
	l_shipdate >= '1993-01-01'
	and l_shipdate < date_add( '1993-01-01' , interval 1 year)
	and l_discount between 0.08 - 0.01 and 0.08 + 0.01
	and l_quantity < 25;
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+-------------+
| id   | select_type | table    | type | possible_keys | key  | key_len | ref  | rows      | filtered | Extra       |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+-------------+
|    1 | SIMPLE      | lineitem | ALL  | i_l_shipdate  | NULL | NULL    | NULL | 179998372 |    30.09 | Using where |
+------+-------------+----------+------+---------------+------+---------+------+-----------+----------+-------------+
--- Time elapsed ---
176



===== 7_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 3524579216 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			year(l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'JORDAN' and n2.n_name = 'JAPAN')
				or (n1.n_name = 'JAPAN' and n2.n_name = 'JORDAN')
			)
			and l_shipdate between date('1995-01-01') and date('1996-12-31')
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+---------------------------------------------------------------------+---------+---------+---------------------------+-----------+----------+--------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                       | key     | key_len | ref                       | rows      | filtered | Extra                                                                    |
+------+-------------+----------+--------+---------------------------------------------------------------------+---------+---------+---------------------------+-----------+----------+--------------------------------------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL    | PRIMARY,i_l_shipdate,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | NULL    | NULL    | NULL                      | 179998372 |    50.01 | Using where; Using temporary; Using filesort                             |
|    1 | SIMPLE      | supplier | eq_ref | PRIMARY,i_s_nationkey                                               | PRIMARY | 4       | dbt3.lineitem.l_suppkey   |         1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan        |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY,i_o_custkey                                                 | PRIMARY | 4       | dbt3.lineitem.l_orderkey  |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                                               | PRIMARY | 4       | dbt3.orders.o_custkey     |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | n2       | eq_ref | PRIMARY                                                             | PRIMARY | 4       | dbt3.customer.c_nationkey |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | n1       | eq_ref | PRIMARY                                                             | PRIMARY | 4       | dbt3.supplier.s_nationkey |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
+------+-------------+----------+--------+---------------------------------------------------------------------+---------+---------+---------------------------+-----------+----------+--------------------------------------------------------------------------+
--- Time elapsed ---
662



===== 7_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 3524579216 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			year(l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'JORDAN' and n2.n_name = 'JAPAN')
				or (n1.n_name = 'JAPAN' and n2.n_name = 'JORDAN')
			)
			and l_shipdate between date('1995-01-01') and date('1996-12-31')
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+---------------------------------------------------------------------+---------+---------+---------------------------+-----------+----------+--------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                       | key     | key_len | ref                       | rows      | filtered | Extra                                                                    |
+------+-------------+----------+--------+---------------------------------------------------------------------+---------+---------+---------------------------+-----------+----------+--------------------------------------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL    | PRIMARY,i_l_shipdate,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | NULL    | NULL    | NULL                      | 179998372 |    50.01 | Using where; Using temporary; Using filesort                             |
|    1 | SIMPLE      | supplier | eq_ref | PRIMARY,i_s_nationkey                                               | PRIMARY | 4       | dbt3.lineitem.l_suppkey   |         1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan        |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY,i_o_custkey                                                 | PRIMARY | 4       | dbt3.lineitem.l_orderkey  |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                                               | PRIMARY | 4       | dbt3.orders.o_custkey     |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | n2       | eq_ref | PRIMARY                                                             | PRIMARY | 4       | dbt3.customer.c_nationkey |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | n1       | eq_ref | PRIMARY                                                             | PRIMARY | 4       | dbt3.supplier.s_nationkey |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
+------+-------------+----------+--------+---------------------------------------------------------------------+---------+---------+---------------------------+-----------+----------+--------------------------------------------------------------------------+
--- Time elapsed ---
667



===== 7_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 3524579216 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	supp_nation,
	cust_nation,
	l_year,
	sum(volume) as revenue
from
	(
		select
			n1.n_name as supp_nation,
			n2.n_name as cust_nation,
			year(l_shipdate) as l_year,
			l_extendedprice * (1 - l_discount) as volume
		from
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2
		where
			s_suppkey = l_suppkey
			and o_orderkey = l_orderkey
			and c_custkey = o_custkey
			and s_nationkey = n1.n_nationkey
			and c_nationkey = n2.n_nationkey
			and (
				(n1.n_name = 'JORDAN' and n2.n_name = 'JAPAN')
				or (n1.n_name = 'JAPAN' and n2.n_name = 'JORDAN')
			)
			and l_shipdate between date('1995-01-01') and date('1996-12-31')
	) as shipping
group by
	supp_nation,
	cust_nation,
	l_year
order by
	supp_nation,
	cust_nation,
	l_year;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+---------------------------------------------------------------------+---------+---------+---------------------------+-----------+----------+--------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                       | key     | key_len | ref                       | rows      | filtered | Extra                                                                    |
+------+-------------+----------+--------+---------------------------------------------------------------------+---------+---------+---------------------------+-----------+----------+--------------------------------------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL    | PRIMARY,i_l_shipdate,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | NULL    | NULL    | NULL                      | 179998372 |    49.89 | Using where; Using temporary; Using filesort                             |
|    1 | SIMPLE      | supplier | eq_ref | PRIMARY,i_s_nationkey                                               | PRIMARY | 4       | dbt3.lineitem.l_suppkey   |         1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan        |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY,i_o_custkey                                                 | PRIMARY | 4       | dbt3.lineitem.l_orderkey  |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                                               | PRIMARY | 4       | dbt3.orders.o_custkey     |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | n2       | eq_ref | PRIMARY                                                             | PRIMARY | 4       | dbt3.customer.c_nationkey |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | n1       | eq_ref | PRIMARY                                                             | PRIMARY | 4       | dbt3.supplier.s_nationkey |         1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
+------+-------------+----------+--------+---------------------------------------------------------------------+---------+---------+---------------------------+-----------+----------+--------------------------------------------------------------------------+
--- Time elapsed ---
670



===== 8_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 224546096 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	o_year,
	sum(case
		when nation = 'UNITED KINGDOM' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			year(o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'EUROPE'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date('1995-01-01') and date ('1996-12-31')
			and p_type = 'ECONOMY PLATED NICKEL'
	) as all_nations
group by
	o_year
order by
	o_year;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                                          | key     | key_len | ref                       | rows     | filtered | Extra                                                                    |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | ALL    | PRIMARY,i_o_orderdate,i_o_custkey                                                      | NULL    | NULL    | NULL                      | 45000000 |    49.93 | Using where; Using temporary; Using filesort                             |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                                                                  | PRIMARY | 4       | dbt3.orders.o_custkey     |        1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan        |
|    1 | SIMPLE      | n1       | eq_ref | PRIMARY,i_n_regionkey                                                                  | PRIMARY | 4       | dbt3.customer.c_nationkey |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | PRIMARY | 4       | dbt3.orders.o_orderkey    |        3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                                                                | PRIMARY | 4       | dbt3.lineitem.l_partkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | region   | eq_ref | PRIMARY                                                                                | PRIMARY | 4       | dbt3.n1.n_regionkey       |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | supplier | eq_ref | PRIMARY,i_s_nationkey                                                                  | PRIMARY | 4       | dbt3.lineitem.l_suppkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | n2       | eq_ref | PRIMARY                                                                                | PRIMARY | 4       | dbt3.supplier.s_nationkey |        1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan              |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
--- Time elapsed ---
1518



===== 8_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 224546096 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	o_year,
	sum(case
		when nation = 'UNITED KINGDOM' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			year(o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'EUROPE'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date('1995-01-01') and date ('1996-12-31')
			and p_type = 'ECONOMY PLATED NICKEL'
	) as all_nations
group by
	o_year
order by
	o_year;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                                          | key     | key_len | ref                       | rows     | filtered | Extra                                                                    |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | ALL    | PRIMARY,i_o_orderdate,i_o_custkey                                                      | NULL    | NULL    | NULL                      | 45000000 |    50.13 | Using where; Using temporary; Using filesort                             |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                                                                  | PRIMARY | 4       | dbt3.orders.o_custkey     |        1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan        |
|    1 | SIMPLE      | n1       | eq_ref | PRIMARY,i_n_regionkey                                                                  | PRIMARY | 4       | dbt3.customer.c_nationkey |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | PRIMARY | 4       | dbt3.orders.o_orderkey    |        3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                                                                | PRIMARY | 4       | dbt3.lineitem.l_partkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | region   | eq_ref | PRIMARY                                                                                | PRIMARY | 4       | dbt3.n1.n_regionkey       |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | supplier | eq_ref | PRIMARY,i_s_nationkey                                                                  | PRIMARY | 4       | dbt3.lineitem.l_suppkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | n2       | eq_ref | PRIMARY                                                                                | PRIMARY | 4       | dbt3.supplier.s_nationkey |        1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan              |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
--- Time elapsed ---
1491



===== 8_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 224546096 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	o_year,
	sum(case
		when nation = 'UNITED KINGDOM' then volume
		else 0
	end) / sum(volume) as mkt_share
from
	(
		select
			year(o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) as volume,
			n2.n_name as nation
		from
			part,
			supplier,
			lineitem,
			orders,
			customer,
			nation n1,
			nation n2,
			region
		where
			p_partkey = l_partkey
			and s_suppkey = l_suppkey
			and l_orderkey = o_orderkey
			and o_custkey = c_custkey
			and c_nationkey = n1.n_nationkey
			and n1.n_regionkey = r_regionkey
			and r_name = 'EUROPE'
			and s_nationkey = n2.n_nationkey
			and o_orderdate between date('1995-01-01') and date ('1996-12-31')
			and p_type = 'ECONOMY PLATED NICKEL'
	) as all_nations
group by
	o_year
order by
	o_year;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                                          | key     | key_len | ref                       | rows     | filtered | Extra                                                                    |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | ALL    | PRIMARY,i_o_orderdate,i_o_custkey                                                      | NULL    | NULL    | NULL                      | 45000000 |    50.08 | Using where; Using temporary; Using filesort                             |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                                                                  | PRIMARY | 4       | dbt3.orders.o_custkey     |        1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan        |
|    1 | SIMPLE      | n1       | eq_ref | PRIMARY,i_n_regionkey                                                                  | PRIMARY | 4       | dbt3.customer.c_nationkey |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | PRIMARY | 4       | dbt3.orders.o_orderkey    |        3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                                                                | PRIMARY | 4       | dbt3.lineitem.l_partkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | region   | eq_ref | PRIMARY                                                                                | PRIMARY | 4       | dbt3.n1.n_regionkey       |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | supplier | eq_ref | PRIMARY,i_s_nationkey                                                                  | PRIMARY | 4       | dbt3.lineitem.l_suppkey   |        1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan |
|    1 | SIMPLE      | n2       | eq_ref | PRIMARY                                                                                | PRIMARY | 4       | dbt3.supplier.s_nationkey |        1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan              |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------+---------+---------------------------+----------+----------+--------------------------------------------------------------------------+
--- Time elapsed ---
1531



===== 9_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 1219480272 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			year(o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                                          | key                 | key_len | ref                                              | rows  | filtered | Extra                                                                     |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
|    1 | SIMPLE      | nation   | ALL    | PRIMARY                                                                                | NULL                | NULL    | NULL                                             |    25 |   100.00 | Using temporary; Using filesort                                           |
|    1 | SIMPLE      | supplier | ref    | PRIMARY,i_s_nationkey                                                                  | i_s_nationkey       | 5       | dbt3.nation.n_nationkey                          | 12000 |   100.00 | Using index                                                               |
|    1 | SIMPLE      | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                                                      | i_ps_suppkey        | 4       | dbt3.supplier.s_suppkey                          |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan        |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.partsupp.ps_partkey                         |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan  |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | i_l_suppkey_partkey | 10      | dbt3.partsupp.ps_partkey,dbt3.supplier.s_suppkey |     7 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.lineitem.l_orderkey                         |     1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan               |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
--- Time elapsed ---
924



===== 9_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 1219480272 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			year(o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                                          | key                 | key_len | ref                                              | rows  | filtered | Extra                                                                     |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
|    1 | SIMPLE      | nation   | ALL    | PRIMARY                                                                                | NULL                | NULL    | NULL                                             |    25 |   100.00 | Using temporary; Using filesort                                           |
|    1 | SIMPLE      | supplier | ref    | PRIMARY,i_s_nationkey                                                                  | i_s_nationkey       | 5       | dbt3.nation.n_nationkey                          | 12000 |   100.00 | Using index                                                               |
|    1 | SIMPLE      | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                                                      | i_ps_suppkey        | 4       | dbt3.supplier.s_suppkey                          |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan        |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.partsupp.ps_partkey                         |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan  |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | i_l_suppkey_partkey | 10      | dbt3.partsupp.ps_partkey,dbt3.supplier.s_suppkey |     7 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.lineitem.l_orderkey                         |     1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan               |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
--- Time elapsed ---
916



===== 9_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 1219480272 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			year(o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                                          | key                 | key_len | ref                                              | rows  | filtered | Extra                                                                     |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
|    1 | SIMPLE      | nation   | ALL    | PRIMARY                                                                                | NULL                | NULL    | NULL                                             |    25 |   100.00 | Using temporary; Using filesort                                           |
|    1 | SIMPLE      | supplier | ref    | PRIMARY,i_s_nationkey                                                                  | i_s_nationkey       | 5       | dbt3.nation.n_nationkey                          | 12000 |   100.00 | Using index                                                               |
|    1 | SIMPLE      | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                                                      | i_ps_suppkey        | 4       | dbt3.supplier.s_suppkey                          |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan        |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.partsupp.ps_partkey                         |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan  |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | i_l_suppkey_partkey | 10      | dbt3.partsupp.ps_partkey,dbt3.supplier.s_suppkey |     7 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.lineitem.l_orderkey                         |     1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan               |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
--- Time elapsed ---
948



===== 9-opt_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 1219480272 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			year(o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from nation STRAIGHT_JOIN supplier STRAIGHT_JOIN partsupp STRAIGHT_JOIN
		     part STRAIGHT_JOIN lineitem STRAIGHT_JOIN orders
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                                          | key                 | key_len | ref                                              | rows  | filtered | Extra                                                                     |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
|    1 | SIMPLE      | nation   | ALL    | PRIMARY                                                                                | NULL                | NULL    | NULL                                             |    25 |   100.00 | Using temporary; Using filesort                                           |
|    1 | SIMPLE      | supplier | ref    | PRIMARY,i_s_nationkey                                                                  | i_s_nationkey       | 5       | dbt3.nation.n_nationkey                          | 12000 |   100.00 | Using index                                                               |
|    1 | SIMPLE      | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                                                      | i_ps_suppkey        | 4       | dbt3.supplier.s_suppkey                          |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan        |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.partsupp.ps_partkey                         |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan  |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | i_l_suppkey_partkey | 10      | dbt3.partsupp.ps_partkey,dbt3.supplier.s_suppkey |     7 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.lineitem.l_orderkey                         |     1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan               |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
--- Time elapsed ---
937



===== 9-opt_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 1219480272 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			year(o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from nation STRAIGHT_JOIN supplier STRAIGHT_JOIN partsupp STRAIGHT_JOIN
		     part STRAIGHT_JOIN lineitem STRAIGHT_JOIN orders
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                                          | key                 | key_len | ref                                              | rows  | filtered | Extra                                                                     |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
|    1 | SIMPLE      | nation   | ALL    | PRIMARY                                                                                | NULL                | NULL    | NULL                                             |    25 |   100.00 | Using temporary; Using filesort                                           |
|    1 | SIMPLE      | supplier | ref    | PRIMARY,i_s_nationkey                                                                  | i_s_nationkey       | 5       | dbt3.nation.n_nationkey                          | 12000 |   100.00 | Using index                                                               |
|    1 | SIMPLE      | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                                                      | i_ps_suppkey        | 4       | dbt3.supplier.s_suppkey                          |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan        |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.partsupp.ps_partkey                         |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan  |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | i_l_suppkey_partkey | 10      | dbt3.partsupp.ps_partkey,dbt3.supplier.s_suppkey |     7 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.lineitem.l_orderkey                         |     1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan               |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
--- Time elapsed ---
911



===== 9-opt_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 1219480272 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			year(o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from nation STRAIGHT_JOIN supplier STRAIGHT_JOIN partsupp STRAIGHT_JOIN
		     part STRAIGHT_JOIN lineitem STRAIGHT_JOIN orders
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                                                          | key                 | key_len | ref                                              | rows  | filtered | Extra                                                                     |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
|    1 | SIMPLE      | nation   | ALL    | PRIMARY                                                                                | NULL                | NULL    | NULL                                             |    25 |   100.00 | Using temporary; Using filesort                                           |
|    1 | SIMPLE      | supplier | ref    | PRIMARY,i_s_nationkey                                                                  | i_s_nationkey       | 5       | dbt3.nation.n_nationkey                          | 12000 |   100.00 | Using index                                                               |
|    1 | SIMPLE      | partsupp | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                                                      | i_ps_suppkey        | 4       | dbt3.supplier.s_suppkey                          |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan        |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.partsupp.ps_partkey                         |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan  |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | i_l_suppkey_partkey | 10      | dbt3.partsupp.ps_partkey,dbt3.supplier.s_suppkey |     7 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                                                | PRIMARY             | 4       | dbt3.lineitem.l_orderkey                         |     1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan               |
+------+-------------+----------+--------+----------------------------------------------------------------------------------------+---------------------+---------+--------------------------------------------------+-------+----------+---------------------------------------------------------------------------+
--- Time elapsed ---
930



===== 10_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 2214414448 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= '1993-07-01'
	and o_orderdate < date_add( '1993-07-01' , interval 3 month)
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+--------------------------------------------+---------------+---------+---------------------------+---------+----------+-----------------------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                              | key           | key_len | ref                       | rows    | filtered | Extra                                                                                   |
+------+-------------+----------+--------+--------------------------------------------+---------------+---------+---------------------------+---------+----------+-----------------------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | range  | PRIMARY,i_o_orderdate,i_o_custkey          | i_o_orderdate | 4       | NULL                      | 3529344 |   100.00 | Using index condition; Using where; Rowid-ordered scan; Using temporary; Using filesort |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                      | PRIMARY       | 4       | dbt3.orders.o_custkey     |       1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan                       |
|    1 | SIMPLE      | nation   | eq_ref | PRIMARY                                    | PRIMARY       | 4       | dbt3.customer.c_nationkey |       1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan                             |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | PRIMARY       | 4       | dbt3.orders.o_orderkey    |       3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan                |
+------+-------------+----------+--------+--------------------------------------------+---------------+---------+---------------------------+---------+----------+-----------------------------------------------------------------------------------------+
--- Time elapsed ---
984



===== 10_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 2214414448 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= '1993-07-01'
	and o_orderdate < date_add( '1993-07-01' , interval 3 month)
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+--------------------------------------------+---------------+---------+---------------------------+---------+----------+-----------------------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                              | key           | key_len | ref                       | rows    | filtered | Extra                                                                                   |
+------+-------------+----------+--------+--------------------------------------------+---------------+---------+---------------------------+---------+----------+-----------------------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | range  | PRIMARY,i_o_orderdate,i_o_custkey          | i_o_orderdate | 4       | NULL                      | 3529344 |   100.00 | Using index condition; Using where; Rowid-ordered scan; Using temporary; Using filesort |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                      | PRIMARY       | 4       | dbt3.orders.o_custkey     |       1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan                       |
|    1 | SIMPLE      | nation   | eq_ref | PRIMARY                                    | PRIMARY       | 4       | dbt3.customer.c_nationkey |       1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan                             |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | PRIMARY       | 4       | dbt3.orders.o_orderkey    |       3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan                |
+------+-------------+----------+--------+--------------------------------------------+---------------+---------+---------------------------+---------+----------+-----------------------------------------------------------------------------------------+
--- Time elapsed ---
1000



===== 10_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 2214414448 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_custkey,
	c_name,
	sum(l_extendedprice * (1 - l_discount)) as revenue,
	c_acctbal,
	n_name,
	c_address,
	c_phone,
	c_comment
from
	customer,
	orders,
	lineitem,
	nation
where
	c_custkey = o_custkey
	and l_orderkey = o_orderkey
	and o_orderdate >= '1993-07-01'
	and o_orderdate < date_add( '1993-07-01' , interval 3 month)
	and l_returnflag = 'R'
	and c_nationkey = n_nationkey
group by
	c_custkey,
	c_name,
	c_acctbal,
	c_phone,
	n_name,
	c_address,
	c_comment
order by
	revenue desc
LIMIT 20;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+--------------------------------------------+---------------+---------+---------------------------+---------+----------+-----------------------------------------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                              | key           | key_len | ref                       | rows    | filtered | Extra                                                                                   |
+------+-------------+----------+--------+--------------------------------------------+---------------+---------+---------------------------+---------+----------+-----------------------------------------------------------------------------------------+
|    1 | SIMPLE      | orders   | range  | PRIMARY,i_o_orderdate,i_o_custkey          | i_o_orderdate | 4       | NULL                      | 3529344 |   100.00 | Using index condition; Using where; Rowid-ordered scan; Using temporary; Using filesort |
|    1 | SIMPLE      | customer | eq_ref | PRIMARY,i_c_nationkey                      | PRIMARY       | 4       | dbt3.orders.o_custkey     |       1 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan                       |
|    1 | SIMPLE      | nation   | eq_ref | PRIMARY                                    | PRIMARY       | 4       | dbt3.customer.c_nationkey |       1 |   100.00 | Using join buffer (incremental, BKA join); Key-ordered scan                             |
|    1 | SIMPLE      | lineitem | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | PRIMARY       | 4       | dbt3.orders.o_orderkey    |       3 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan                |
+------+-------------+----------+--------+--------------------------------------------+---------------+---------+---------------------------+---------+----------+-----------------------------------------------------------------------------------------+
--- Time elapsed ---
983



===== 11_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 3209348624 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0000033333
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'UNITED STATES'
		)
order by
	value desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+------+-----------------------+---------------+---------+-------------------------+-------+----------+--------------------------------------------------------------------+
| id   | select_type | table    | type | possible_keys         | key           | key_len | ref                     | rows  | filtered | Extra                                                              |
+------+-------------+----------+------+-----------------------+---------------+---------+-------------------------+-------+----------+--------------------------------------------------------------------+
|    1 | PRIMARY     | nation   | ALL  | PRIMARY               | NULL          | NULL    | NULL                    |    25 |   100.00 | Using where; Using temporary; Using filesort                       |
|    1 | PRIMARY     | supplier | ref  | PRIMARY,i_s_nationkey | i_s_nationkey | 5       | dbt3.nation.n_nationkey | 12000 |   100.00 | Using index                                                        |
|    1 | PRIMARY     | partsupp | ref  | i_ps_suppkey          | i_ps_suppkey  | 4       | dbt3.supplier.s_suppkey |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
|    2 | SUBQUERY    | nation   | ALL  | PRIMARY               | NULL          | NULL    | NULL                    |    25 |   100.00 | Using where                                                        |
|    2 | SUBQUERY    | supplier | ref  | PRIMARY,i_s_nationkey | i_s_nationkey | 5       | dbt3.nation.n_nationkey | 12000 |   100.00 | Using index                                                        |
|    2 | SUBQUERY    | partsupp | ref  | i_ps_suppkey          | i_ps_suppkey  | 4       | dbt3.supplier.s_suppkey |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+----------+------+-----------------------+---------------+---------+-------------------------+-------+----------+--------------------------------------------------------------------+
--- Time elapsed ---
106



===== 11_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 3209348624 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0000033333
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'UNITED STATES'
		)
order by
	value desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+------+-----------------------+---------------+---------+-------------------------+-------+----------+--------------------------------------------------------------------+
| id   | select_type | table    | type | possible_keys         | key           | key_len | ref                     | rows  | filtered | Extra                                                              |
+------+-------------+----------+------+-----------------------+---------------+---------+-------------------------+-------+----------+--------------------------------------------------------------------+
|    1 | PRIMARY     | nation   | ALL  | PRIMARY               | NULL          | NULL    | NULL                    |    25 |   100.00 | Using where; Using temporary; Using filesort                       |
|    1 | PRIMARY     | supplier | ref  | PRIMARY,i_s_nationkey | i_s_nationkey | 5       | dbt3.nation.n_nationkey | 12000 |   100.00 | Using index                                                        |
|    1 | PRIMARY     | partsupp | ref  | i_ps_suppkey          | i_ps_suppkey  | 4       | dbt3.supplier.s_suppkey |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
|    2 | SUBQUERY    | nation   | ALL  | PRIMARY               | NULL          | NULL    | NULL                    |    25 |   100.00 | Using where                                                        |
|    2 | SUBQUERY    | supplier | ref  | PRIMARY,i_s_nationkey | i_s_nationkey | 5       | dbt3.nation.n_nationkey | 12000 |   100.00 | Using index                                                        |
|    2 | SUBQUERY    | partsupp | ref  | i_ps_suppkey          | i_ps_suppkey  | 4       | dbt3.supplier.s_suppkey |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+----------+------+-----------------------+---------------+---------+-------------------------+-------+----------+--------------------------------------------------------------------+
--- Time elapsed ---
87



===== 11_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 3209348624 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	ps_partkey,
	sum(ps_supplycost * ps_availqty) as value
from
	partsupp,
	supplier,
	nation
where
	ps_suppkey = s_suppkey
	and s_nationkey = n_nationkey
	and n_name = 'UNITED STATES'
group by
	ps_partkey having
		sum(ps_supplycost * ps_availqty) > (
			select
				sum(ps_supplycost * ps_availqty) * 0.0000033333
			from
				partsupp,
				supplier,
				nation
			where
				ps_suppkey = s_suppkey
				and s_nationkey = n_nationkey
				and n_name = 'UNITED STATES'
		)
order by
	value desc;
COMMIT;

--- Explain result ---
+------+-------------+----------+------+-----------------------+---------------+---------+-------------------------+-------+----------+--------------------------------------------------------------------+
| id   | select_type | table    | type | possible_keys         | key           | key_len | ref                     | rows  | filtered | Extra                                                              |
+------+-------------+----------+------+-----------------------+---------------+---------+-------------------------+-------+----------+--------------------------------------------------------------------+
|    1 | PRIMARY     | nation   | ALL  | PRIMARY               | NULL          | NULL    | NULL                    |    25 |   100.00 | Using where; Using temporary; Using filesort                       |
|    1 | PRIMARY     | supplier | ref  | PRIMARY,i_s_nationkey | i_s_nationkey | 5       | dbt3.nation.n_nationkey | 12000 |   100.00 | Using index                                                        |
|    1 | PRIMARY     | partsupp | ref  | i_ps_suppkey          | i_ps_suppkey  | 4       | dbt3.supplier.s_suppkey |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
|    2 | SUBQUERY    | nation   | ALL  | PRIMARY               | NULL          | NULL    | NULL                    |    25 |   100.00 | Using where                                                        |
|    2 | SUBQUERY    | supplier | ref  | PRIMARY,i_s_nationkey | i_s_nationkey | 5       | dbt3.nation.n_nationkey | 12000 |   100.00 | Using index                                                        |
|    2 | SUBQUERY    | partsupp | ref  | i_ps_suppkey          | i_ps_suppkey  | 4       | dbt3.supplier.s_suppkey |    80 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+----------+------+-----------------------+---------------+---------+-------------------------+-------+----------+--------------------------------------------------------------------+
--- Time elapsed ---
89



===== 12_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 4204282800 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('REG AIR', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= '1996-01-01'
	and l_receiptdate < date_add( '1996-01-01' , interval 1 year)
group by
	l_shipmode
order by
	l_shipmode;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                              | key     | key_len | ref                      | rows      | filtered | Extra                                                |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL    | PRIMARY,i_l_receiptdate,i_l_orderkey,i_l_orderkey_quantity | NULL    | NULL    | NULL                     | 179998372 |    30.47 | Using where; Using temporary; Using filesort         |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                    | PRIMARY | 4       | dbt3.lineitem.l_orderkey |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
228



===== 12_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 4204282800 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('REG AIR', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= '1996-01-01'
	and l_receiptdate < date_add( '1996-01-01' , interval 1 year)
group by
	l_shipmode
order by
	l_shipmode;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                              | key     | key_len | ref                      | rows      | filtered | Extra                                                |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL    | PRIMARY,i_l_receiptdate,i_l_orderkey,i_l_orderkey_quantity | NULL    | NULL    | NULL                     | 179998372 |    30.47 | Using where; Using temporary; Using filesort         |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                    | PRIMARY | 4       | dbt3.lineitem.l_orderkey |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
217



===== 12_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 4204282800 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
	orders,
	lineitem
where
	o_orderkey = l_orderkey
	and l_shipmode in ('REG AIR', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= '1996-01-01'
	and l_receiptdate < date_add( '1996-01-01' , interval 1 year)
group by
	l_shipmode
order by
	l_shipmode;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                              | key     | key_len | ref                      | rows      | filtered | Extra                                                |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL    | PRIMARY,i_l_receiptdate,i_l_orderkey,i_l_orderkey_quantity | NULL    | NULL    | NULL                     | 179998372 |    30.47 | Using where; Using temporary; Using filesort         |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                    | PRIMARY | 4       | dbt3.lineitem.l_orderkey |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
235



===== 12-opt_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 4204282800 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
        lineitem straight_join orders
where
	o_orderkey = l_orderkey
	and l_shipmode in ('REG AIR', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= '1996-01-01'
	and l_receiptdate < date_add( '1996-01-01' , interval 1 year)
group by
	l_shipmode
order by
	l_shipmode;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                              | key     | key_len | ref                      | rows      | filtered | Extra                                                |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL    | PRIMARY,i_l_receiptdate,i_l_orderkey,i_l_orderkey_quantity | NULL    | NULL    | NULL                     | 179998372 |    30.47 | Using where; Using temporary; Using filesort         |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                    | PRIMARY | 4       | dbt3.lineitem.l_orderkey |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
236



===== 12-opt_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 4204282800 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
        lineitem straight_join orders
where
	o_orderkey = l_orderkey
	and l_shipmode in ('REG AIR', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= '1996-01-01'
	and l_receiptdate < date_add( '1996-01-01' , interval 1 year)
group by
	l_shipmode
order by
	l_shipmode;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                              | key     | key_len | ref                      | rows      | filtered | Extra                                                |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL    | PRIMARY,i_l_receiptdate,i_l_orderkey,i_l_orderkey_quantity | NULL    | NULL    | NULL                     | 179998372 |    30.47 | Using where; Using temporary; Using filesort         |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                    | PRIMARY | 4       | dbt3.lineitem.l_orderkey |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
228



===== 12-opt_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 4204282800 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	l_shipmode,
	sum(case
		when o_orderpriority = '1-URGENT'
			or o_orderpriority = '2-HIGH'
			then 1
		else 0
	end) as high_line_count,
	sum(case
		when o_orderpriority <> '1-URGENT'
			and o_orderpriority <> '2-HIGH'
			then 1
		else 0
	end) as low_line_count
from
        lineitem straight_join orders
where
	o_orderkey = l_orderkey
	and l_shipmode in ('REG AIR', 'MAIL')
	and l_commitdate < l_receiptdate
	and l_shipdate < l_commitdate
	and l_receiptdate >= '1996-01-01'
	and l_receiptdate < date_add( '1996-01-01' , interval 1 year)
group by
	l_shipmode
order by
	l_shipmode;
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                              | key     | key_len | ref                      | rows      | filtered | Extra                                                |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
|    1 | SIMPLE      | lineitem | ALL    | PRIMARY,i_l_receiptdate,i_l_orderkey,i_l_orderkey_quantity | NULL    | NULL    | NULL                     | 179998372 |    30.47 | Using where; Using temporary; Using filesort         |
|    1 | SIMPLE      | orders   | eq_ref | PRIMARY                                                    | PRIMARY | 4       | dbt3.lineitem.l_orderkey |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
+------+-------------+----------+--------+------------------------------------------------------------+---------+---------+--------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
222



===== 13_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 904249680 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey) as c_count
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%express%requests%'
		group by
			c_custkey
	) as c_orders
group by
	c_count
order by
	custdist desc,
	c_count desc;
COMMIT;

--- Explain result ---
+------+-------------+------------+------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------------------------------------------------------+
| id   | select_type | table      | type | possible_keys | key         | key_len | ref                     | rows    | filtered | Extra                                                                           |
+------+-------------+------------+------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------------------------------------------------------+
|    1 | PRIMARY     | <derived2> | ALL  | NULL          | NULL        | NULL    | NULL                    |       0 |     0.00 | Using temporary; Using filesort                                                 |
|    2 | DERIVED     | customer   | ALL  | NULL          | NULL        | NULL    | NULL                    | 4500000 |   100.00 | Using temporary; Using filesort                                                 |
|    2 | DERIVED     | orders     | ref  | i_o_custkey   | i_o_custkey | 5       | dbt3.customer.c_custkey |      15 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+------------+------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------------------------------------------------------+
--- Time elapsed ---
604



===== 13_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 904249680 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey) as c_count
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%express%requests%'
		group by
			c_custkey
	) as c_orders
group by
	c_count
order by
	custdist desc,
	c_count desc;
COMMIT;

--- Explain result ---
+------+-------------+------------+------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------------------------------------------------------+
| id   | select_type | table      | type | possible_keys | key         | key_len | ref                     | rows    | filtered | Extra                                                                           |
+------+-------------+------------+------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------------------------------------------------------+
|    1 | PRIMARY     | <derived2> | ALL  | NULL          | NULL        | NULL    | NULL                    |       0 |     0.00 | Using temporary; Using filesort                                                 |
|    2 | DERIVED     | customer   | ALL  | NULL          | NULL        | NULL    | NULL                    | 4500000 |   100.00 | Using temporary; Using filesort                                                 |
|    2 | DERIVED     | orders     | ref  | i_o_custkey   | i_o_custkey | 5       | dbt3.customer.c_custkey |      15 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+------------+------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------------------------------------------------------+
--- Time elapsed ---
613



===== 13_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 904249680 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_count,
	count(*) as custdist
from
	(
		select
			c_custkey,
			count(o_orderkey) as c_count
		from
			customer left outer join orders on
				c_custkey = o_custkey
				and o_comment not like '%express%requests%'
		group by
			c_custkey
	) as c_orders
group by
	c_count
order by
	custdist desc,
	c_count desc;
COMMIT;

--- Explain result ---
+------+-------------+------------+------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------------------------------------------------------+
| id   | select_type | table      | type | possible_keys | key         | key_len | ref                     | rows    | filtered | Extra                                                                           |
+------+-------------+------------+------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------------------------------------------------------+
|    1 | PRIMARY     | <derived2> | ALL  | NULL          | NULL        | NULL    | NULL                    |       0 |     0.00 | Using temporary; Using filesort                                                 |
|    2 | DERIVED     | customer   | ALL  | NULL          | NULL        | NULL    | NULL                    | 4500000 |   100.00 | Using temporary; Using filesort                                                 |
|    2 | DERIVED     | orders     | ref  | i_o_custkey   | i_o_custkey | 5       | dbt3.customer.c_custkey |      15 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+------------+------+---------------+-------------+---------+-------------------------+---------+----------+---------------------------------------------------------------------------------+
--- Time elapsed ---
625



===== 14_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 1899183856 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= '1994-01-01'
	and l_shipdate < date_add( '1994-01-01' , interval 1 month);
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+---------+----------+--------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                | key          | key_len | ref                     | rows    | filtered | Extra                                                  |
+------+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+---------+----------+--------------------------------------------------------+
|    1 | SIMPLE      | lineitem | range  | i_l_shipdate,i_l_suppkey_partkey,i_l_partkey | i_l_shipdate | 4       | NULL                    | 4302830 |   100.00 | Using index condition; Using where; Rowid-ordered scan |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                      | PRIMARY      | 4       | dbt3.lineitem.l_partkey |       1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan   |
+------+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+---------+----------+--------------------------------------------------------+
--- Time elapsed ---
215



===== 14_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 1899183856 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= '1994-01-01'
	and l_shipdate < date_add( '1994-01-01' , interval 1 month);
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+---------+----------+--------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                | key          | key_len | ref                     | rows    | filtered | Extra                                                  |
+------+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+---------+----------+--------------------------------------------------------+
|    1 | SIMPLE      | lineitem | range  | i_l_shipdate,i_l_suppkey_partkey,i_l_partkey | i_l_shipdate | 4       | NULL                    | 4302830 |   100.00 | Using index condition; Using where; Rowid-ordered scan |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                      | PRIMARY      | 4       | dbt3.lineitem.l_partkey |       1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan   |
+------+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+---------+----------+--------------------------------------------------------+
--- Time elapsed ---
226



===== 14_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 1899183856 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	100.00 * sum(case
		when p_type like 'PROMO%'
			then l_extendedprice * (1 - l_discount)
		else 0
	end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue
from
	lineitem,
	part
where
	l_partkey = p_partkey
	and l_shipdate >= '1994-01-01'
	and l_shipdate < date_add( '1994-01-01' , interval 1 month);
COMMIT;

--- Explain result ---
+------+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+---------+----------+--------------------------------------------------------+
| id   | select_type | table    | type   | possible_keys                                | key          | key_len | ref                     | rows    | filtered | Extra                                                  |
+------+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+---------+----------+--------------------------------------------------------+
|    1 | SIMPLE      | lineitem | range  | i_l_shipdate,i_l_suppkey_partkey,i_l_partkey | i_l_shipdate | 4       | NULL                    | 4302830 |   100.00 | Using index condition; Using where; Rowid-ordered scan |
|    1 | SIMPLE      | part     | eq_ref | PRIMARY                                      | PRIMARY      | 4       | dbt3.lineitem.l_partkey |       1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan   |
+------+-------------+----------+--------+----------------------------------------------+--------------+---------+-------------------------+---------+----------+--------------------------------------------------------+
--- Time elapsed ---
216



===== 15_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 2894118032 as a seed to the RNG
BEGIN;

create or replace view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= '1993-06-01'
		and l_shipdate < date_add('1993-06-01', interval 90 day)
	group by
		l_suppkey;

EXPLAIN EXTENDED


select
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;

drop view revenue0;
COMMIT;

--- Explain result ---
+------+-------------+------------+--------+---------------+--------------+---------+----------------------+----------+----------+----------------------------------------------------------------------------+
| id   | select_type | table      | type   | possible_keys | key          | key_len | ref                  | rows     | filtered | Extra                                                                      |
+------+-------------+------------+--------+---------------+--------------+---------+----------------------+----------+----------+----------------------------------------------------------------------------+
|    1 | PRIMARY     | <derived3> | ALL    | NULL          | NULL         | NULL    | NULL                 |        0 |     0.00 | Using where; Using temporary; Using filesort                               |
|    1 | PRIMARY     | supplier   | eq_ref | PRIMARY       | PRIMARY      | 4       | revenue0.supplier_no |        1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan                       |
|    3 | DERIVED     | lineitem   | range  | i_l_shipdate  | i_l_shipdate | 4       | NULL                 | 13143886 |   100.00 | Using index condition; Rowid-ordered scan; Using temporary; Using filesort |
|    2 | SUBQUERY    | <derived4> | ALL    | NULL          | NULL         | NULL    | NULL                 |        0 |     0.00 |                                                                            |
|    4 | DERIVED     | lineitem   | range  | i_l_shipdate  | i_l_shipdate | 4       | NULL                 | 13143886 |   100.00 | Using index condition; Rowid-ordered scan; Using temporary; Using filesort |
+------+-------------+------------+--------+---------------+--------------+---------+----------------------+----------+----------+----------------------------------------------------------------------------+
--- Time elapsed ---
658



===== 15_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 2894118032 as a seed to the RNG
BEGIN;

create or replace view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= '1993-06-01'
		and l_shipdate < date_add('1993-06-01', interval 90 day)
	group by
		l_suppkey;

EXPLAIN EXTENDED


select
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;

drop view revenue0;
COMMIT;

--- Explain result ---
+------+-------------+------------+--------+---------------+--------------+---------+----------------------+----------+----------+----------------------------------------------------------------------------+
| id   | select_type | table      | type   | possible_keys | key          | key_len | ref                  | rows     | filtered | Extra                                                                      |
+------+-------------+------------+--------+---------------+--------------+---------+----------------------+----------+----------+----------------------------------------------------------------------------+
|    1 | PRIMARY     | <derived3> | ALL    | NULL          | NULL         | NULL    | NULL                 |        0 |     0.00 | Using where; Using temporary; Using filesort                               |
|    1 | PRIMARY     | supplier   | eq_ref | PRIMARY       | PRIMARY      | 4       | revenue0.supplier_no |        1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan                       |
|    3 | DERIVED     | lineitem   | range  | i_l_shipdate  | i_l_shipdate | 4       | NULL                 | 13143886 |   100.00 | Using index condition; Rowid-ordered scan; Using temporary; Using filesort |
|    2 | SUBQUERY    | <derived4> | ALL    | NULL          | NULL         | NULL    | NULL                 |        0 |     0.00 |                                                                            |
|    4 | DERIVED     | lineitem   | range  | i_l_shipdate  | i_l_shipdate | 4       | NULL                 | 13143886 |   100.00 | Using index condition; Rowid-ordered scan; Using temporary; Using filesort |
+------+-------------+------------+--------+---------------+--------------+---------+----------------------+----------+----------+----------------------------------------------------------------------------+
--- Time elapsed ---
663



===== 15_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 2894118032 as a seed to the RNG
BEGIN;

create or replace view revenue0 (supplier_no, total_revenue) as
	select
		l_suppkey,
		sum(l_extendedprice * (1 - l_discount))
	from
		lineitem
	where
		l_shipdate >= '1993-06-01'
		and l_shipdate < date_add('1993-06-01', interval 90 day)
	group by
		l_suppkey;

EXPLAIN EXTENDED


select
	s_suppkey,
	s_name,
	s_address,
	s_phone,
	total_revenue
from
	supplier,
	revenue0
where
	s_suppkey = supplier_no
	and total_revenue = (
		select
			max(total_revenue)
		from
			revenue0
	)
order by
	s_suppkey;

drop view revenue0;
COMMIT;

--- Explain result ---
+------+-------------+------------+--------+---------------+--------------+---------+----------------------+----------+----------+----------------------------------------------------------------------------+
| id   | select_type | table      | type   | possible_keys | key          | key_len | ref                  | rows     | filtered | Extra                                                                      |
+------+-------------+------------+--------+---------------+--------------+---------+----------------------+----------+----------+----------------------------------------------------------------------------+
|    1 | PRIMARY     | <derived3> | ALL    | NULL          | NULL         | NULL    | NULL                 |        0 |     0.00 | Using where; Using temporary; Using filesort                               |
|    1 | PRIMARY     | supplier   | eq_ref | PRIMARY       | PRIMARY      | 4       | revenue0.supplier_no |        1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan                       |
|    3 | DERIVED     | lineitem   | range  | i_l_shipdate  | i_l_shipdate | 4       | NULL                 | 13143886 |   100.00 | Using index condition; Rowid-ordered scan; Using temporary; Using filesort |
|    2 | SUBQUERY    | <derived4> | ALL    | NULL          | NULL         | NULL    | NULL                 |        0 |     0.00 |                                                                            |
|    4 | DERIVED     | lineitem   | range  | i_l_shipdate  | i_l_shipdate | 4       | NULL                 | 13143886 |   100.00 | Using index condition; Rowid-ordered scan; Using temporary; Using filesort |
+------+-------------+------------+--------+---------------+--------------+---------+----------------------+----------+----------+----------------------------------------------------------------------------+
--- Time elapsed ---
665



===== 16_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 3889052208 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#11'
	and p_type not like 'STANDARD BRUSHED%'
	and p_size in (21, 36, 1, 8, 4, 44, 47, 23)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
COMMIT;

--- Explain result ---
+------+--------------+----------+------+----------------------+--------------+---------+---------------------+---------+----------+----------------------------------------------+
| id   | select_type  | table    | type | possible_keys        | key          | key_len | ref                 | rows    | filtered | Extra                                        |
+------+--------------+----------+------+----------------------+--------------+---------+---------------------+---------+----------+----------------------------------------------+
|    1 | PRIMARY      | part     | ALL  | PRIMARY              | NULL         | NULL    | NULL                | 6000000 |   100.00 | Using where; Using temporary; Using filesort |
|    1 | PRIMARY      | partsupp | ref  | PRIMARY,i_ps_partkey | i_ps_partkey | 4       | dbt3.part.p_partkey |       4 |   100.00 | Using where; Using index                     |
|    2 | MATERIALIZED | supplier | ALL  | PRIMARY              | NULL         | NULL    | NULL                |  300000 |   100.00 | Using where                                  |
+------+--------------+----------+------+----------------------+--------------+---------+---------------------+---------+----------+----------------------------------------------+
--- Time elapsed ---
80



===== 16_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 3889052208 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#11'
	and p_type not like 'STANDARD BRUSHED%'
	and p_size in (21, 36, 1, 8, 4, 44, 47, 23)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
COMMIT;

--- Explain result ---
+------+--------------+----------+------+----------------------+--------------+---------+---------------------+---------+----------+----------------------------------------------+
| id   | select_type  | table    | type | possible_keys        | key          | key_len | ref                 | rows    | filtered | Extra                                        |
+------+--------------+----------+------+----------------------+--------------+---------+---------------------+---------+----------+----------------------------------------------+
|    1 | PRIMARY      | part     | ALL  | PRIMARY              | NULL         | NULL    | NULL                | 6000000 |   100.00 | Using where; Using temporary; Using filesort |
|    1 | PRIMARY      | partsupp | ref  | PRIMARY,i_ps_partkey | i_ps_partkey | 4       | dbt3.part.p_partkey |       4 |   100.00 | Using where; Using index                     |
|    2 | MATERIALIZED | supplier | ALL  | PRIMARY              | NULL         | NULL    | NULL                |  300000 |   100.00 | Using where                                  |
+------+--------------+----------+------+----------------------+--------------+---------+---------------------+---------+----------+----------------------------------------------+
--- Time elapsed ---
80



===== 16_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 3889052208 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	p_brand,
	p_type,
	p_size,
	count(distinct ps_suppkey) as supplier_cnt
from
	partsupp,
	part
where
	p_partkey = ps_partkey
	and p_brand <> 'Brand#11'
	and p_type not like 'STANDARD BRUSHED%'
	and p_size in (21, 36, 1, 8, 4, 44, 47, 23)
	and ps_suppkey not in (
		select
			s_suppkey
		from
			supplier
		where
			s_comment like '%Customer%Complaints%'
	)
group by
	p_brand,
	p_type,
	p_size
order by
	supplier_cnt desc,
	p_brand,
	p_type,
	p_size;
COMMIT;

--- Explain result ---
+------+--------------+----------+------+----------------------+--------------+---------+---------------------+---------+----------+----------------------------------------------+
| id   | select_type  | table    | type | possible_keys        | key          | key_len | ref                 | rows    | filtered | Extra                                        |
+------+--------------+----------+------+----------------------+--------------+---------+---------------------+---------+----------+----------------------------------------------+
|    1 | PRIMARY      | part     | ALL  | PRIMARY              | NULL         | NULL    | NULL                | 6000000 |   100.00 | Using where; Using temporary; Using filesort |
|    1 | PRIMARY      | partsupp | ref  | PRIMARY,i_ps_partkey | i_ps_partkey | 4       | dbt3.part.p_partkey |       4 |   100.00 | Using where; Using index                     |
|    2 | MATERIALIZED | supplier | ALL  | PRIMARY              | NULL         | NULL    | NULL                |  300000 |   100.00 | Using where                                  |
+------+--------------+----------+------+----------------------+--------------+---------+---------------------+---------+----------+----------------------------------------------+
--- Time elapsed ---
80



===== 17_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 589019088 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	lineitem,
	part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#45'
	and p_container = 'JUMBO DRUM'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			lineitem
		where
			l_partkey = p_partkey
	);
COMMIT;

--- Explain result ---
+------+--------------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+---------------------------------------------------------------------------------+
| id   | select_type        | table    | type | possible_keys                   | key                 | key_len | ref                 | rows    | filtered | Extra                                                                           |
+------+--------------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+---------------------------------------------------------------------------------+
|    1 | PRIMARY            | part     | ALL  | PRIMARY                         | NULL                | NULL    | NULL                | 6000000 |   100.00 | Using where                                                                     |
|    1 | PRIMARY            | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
|    2 | DEPENDENT SUBQUERY | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 |                                                                                 |
+------+--------------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+---------------------------------------------------------------------------------+
--- Time elapsed ---
802



===== 17_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 589019088 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	lineitem,
	part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#45'
	and p_container = 'JUMBO DRUM'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			lineitem
		where
			l_partkey = p_partkey
	);
COMMIT;

--- Explain result ---
+------+--------------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+---------------------------------------------------------------------------------+
| id   | select_type        | table    | type | possible_keys                   | key                 | key_len | ref                 | rows    | filtered | Extra                                                                           |
+------+--------------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+---------------------------------------------------------------------------------+
|    1 | PRIMARY            | part     | ALL  | PRIMARY                         | NULL                | NULL    | NULL                | 6000000 |   100.00 | Using where                                                                     |
|    1 | PRIMARY            | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
|    2 | DEPENDENT SUBQUERY | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 |                                                                                 |
+------+--------------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+---------------------------------------------------------------------------------+
--- Time elapsed ---
808



===== 17_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 589019088 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice) / 7.0 as avg_yearly
from
	lineitem,
	part
where
	p_partkey = l_partkey
	and p_brand = 'Brand#45'
	and p_container = 'JUMBO DRUM'
	and l_quantity < (
		select
			0.2 * avg(l_quantity)
		from
			lineitem
		where
			l_partkey = p_partkey
	);
COMMIT;

--- Explain result ---
+------+--------------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+---------------------------------------------------------------------------------+
| id   | select_type        | table    | type | possible_keys                   | key                 | key_len | ref                 | rows    | filtered | Extra                                                                           |
+------+--------------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+---------------------------------------------------------------------------------+
|    1 | PRIMARY            | part     | ALL  | PRIMARY                         | NULL                | NULL    | NULL                | 6000000 |   100.00 | Using where                                                                     |
|    1 | PRIMARY            | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
|    2 | DEPENDENT SUBQUERY | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 |                                                                                 |
+------+--------------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+---------------------------------------------------------------------------------+
--- Time elapsed ---
806



===== 18-opt_explain.sql Run No: 1 =====
STARTUP_PARAMS: --optimizer_switch='semijoin=off'


-- using 1670342511 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 313
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------+----------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type  | table    | type   | possible_keys                              | key                   | key_len | ref                    | rows      | filtered | Extra                                                |
+------+--------------+----------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
|    1 | PRIMARY      | orders   | ALL    | PRIMARY,i_o_custkey                        | NULL                  | NULL    | NULL                   |  45000000 |   100.00 | Using where; Using temporary; Using filesort         |
|    1 | PRIMARY      | customer | eq_ref | PRIMARY                                    | PRIMARY               | 4       | dbt3.orders.o_custkey  |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
|    1 | PRIMARY      | lineitem | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey_quantity | 4       | dbt3.orders.o_orderkey |         3 |   100.00 | Using index                                          |
|    2 | MATERIALIZED | lineitem | index  | NULL                                       | PRIMARY               | 8       | NULL                   | 179998372 |   100.00 |                                                      |
+------+--------------+----------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
203



===== 18-opt_explain.sql Run No: 2 =====
STARTUP_PARAMS: --optimizer_switch='semijoin=off'


-- using 1670342511 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 313
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------+----------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type  | table    | type   | possible_keys                              | key                   | key_len | ref                    | rows      | filtered | Extra                                                |
+------+--------------+----------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
|    1 | PRIMARY      | orders   | ALL    | PRIMARY,i_o_custkey                        | NULL                  | NULL    | NULL                   |  45000000 |   100.00 | Using where; Using temporary; Using filesort         |
|    1 | PRIMARY      | customer | eq_ref | PRIMARY                                    | PRIMARY               | 4       | dbt3.orders.o_custkey  |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
|    1 | PRIMARY      | lineitem | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey_quantity | 4       | dbt3.orders.o_orderkey |         3 |   100.00 | Using index                                          |
|    2 | MATERIALIZED | lineitem | index  | NULL                                       | PRIMARY               | 8       | NULL                   | 179998372 |   100.00 |                                                      |
+------+--------------+----------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
207



===== 18-opt_explain.sql Run No: 3 =====
STARTUP_PARAMS: --optimizer_switch='semijoin=off'


-- using 1670342511 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 313
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------+----------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type  | table    | type   | possible_keys                              | key                   | key_len | ref                    | rows      | filtered | Extra                                                |
+------+--------------+----------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
|    1 | PRIMARY      | orders   | ALL    | PRIMARY,i_o_custkey                        | NULL                  | NULL    | NULL                   |  45000000 |   100.00 | Using where; Using temporary; Using filesort         |
|    1 | PRIMARY      | customer | eq_ref | PRIMARY                                    | PRIMARY               | 4       | dbt3.orders.o_custkey  |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
|    1 | PRIMARY      | lineitem | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey_quantity | 4       | dbt3.orders.o_orderkey |         3 |   100.00 | Using index                                          |
|    2 | MATERIALIZED | lineitem | index  | NULL                                       | PRIMARY               | 8       | NULL                   | 179998372 |   100.00 |                                                      |
+------+--------------+----------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
203



===== 19_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 2578887440 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#45'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 3 and l_quantity <= 3+10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#14'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 17 and l_quantity <= 17+10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#51'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 27 and l_quantity <= 27+10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
| id   | select_type | table    | type | possible_keys                   | key                 | key_len | ref                 | rows    | filtered | Extra                                                                                                       |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
|    1 | SIMPLE      | part     | ALL  | PRIMARY                         | NULL                | NULL    | NULL                | 6000000 |   100.00 | Using where                                                                                                 |
|    1 | SIMPLE      | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 | Using index condition(BKA); Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
--- Time elapsed ---
112



===== 19_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 2578887440 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#45'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 3 and l_quantity <= 3+10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#14'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 17 and l_quantity <= 17+10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#51'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 27 and l_quantity <= 27+10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
| id   | select_type | table    | type | possible_keys                   | key                 | key_len | ref                 | rows    | filtered | Extra                                                                                                       |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
|    1 | SIMPLE      | part     | ALL  | PRIMARY                         | NULL                | NULL    | NULL                | 6000000 |   100.00 | Using where                                                                                                 |
|    1 | SIMPLE      | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 | Using index condition(BKA); Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
--- Time elapsed ---
108



===== 19_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 2578887440 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#45'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 3 and l_quantity <= 3+10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#14'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 17 and l_quantity <= 17+10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#51'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 27 and l_quantity <= 27+10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
| id   | select_type | table    | type | possible_keys                   | key                 | key_len | ref                 | rows    | filtered | Extra                                                                                                       |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
|    1 | SIMPLE      | part     | ALL  | PRIMARY                         | NULL                | NULL    | NULL                | 6000000 |   100.00 | Using where                                                                                                 |
|    1 | SIMPLE      | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 | Using index condition(BKA); Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
--- Time elapsed ---
110



===== 19-opt1_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 2578887440 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	part straight_join lineitem
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#45'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 3 and l_quantity <= 3+10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#14'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 17 and l_quantity <= 17+10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#51'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 27 and l_quantity <= 27+10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
| id   | select_type | table    | type | possible_keys                   | key                 | key_len | ref                 | rows    | filtered | Extra                                                                                                       |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
|    1 | SIMPLE      | part     | ALL  | PRIMARY                         | NULL                | NULL    | NULL                | 6000000 |   100.00 | Using where                                                                                                 |
|    1 | SIMPLE      | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 | Using index condition(BKA); Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
--- Time elapsed ---
112



===== 19-opt1_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 2578887440 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	part straight_join lineitem
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#45'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 3 and l_quantity <= 3+10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#14'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 17 and l_quantity <= 17+10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#51'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 27 and l_quantity <= 27+10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
| id   | select_type | table    | type | possible_keys                   | key                 | key_len | ref                 | rows    | filtered | Extra                                                                                                       |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
|    1 | SIMPLE      | part     | ALL  | PRIMARY                         | NULL                | NULL    | NULL                | 6000000 |   100.00 | Using where                                                                                                 |
|    1 | SIMPLE      | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 | Using index condition(BKA); Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
--- Time elapsed ---
109



===== 19-opt1_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 2578887440 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	part straight_join lineitem
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#45'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 3 and l_quantity <= 3+10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#14'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 17 and l_quantity <= 17+10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#51'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 27 and l_quantity <= 27+10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);
COMMIT;

--- Explain result ---
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
| id   | select_type | table    | type | possible_keys                   | key                 | key_len | ref                 | rows    | filtered | Extra                                                                                                       |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
|    1 | SIMPLE      | part     | ALL  | PRIMARY                         | NULL                | NULL    | NULL                | 6000000 |   100.00 | Using where                                                                                                 |
|    1 | SIMPLE      | lineitem | ref  | i_l_suppkey_partkey,i_l_partkey | i_l_suppkey_partkey | 5       | dbt3.part.p_partkey |      29 |   100.00 | Using index condition(BKA); Using where; Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
+------+-------------+----------+------+---------------------------------+---------------------+---------+---------------------+---------+----------+-------------------------------------------------------------------------------------------------------------+
--- Time elapsed ---
119



===== 21_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 273788496 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'ALGERIA'
group by
	s_name
order by
	numwait desc,
	s_name
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------------+----------+--------+--------------------------------------------------------+---------------+---------+-------------------------+-------+----------+----------------------------------------------------------------------------------------+
| id   | select_type        | table    | type   | possible_keys                                          | key           | key_len | ref                     | rows  | filtered | Extra                                                                                  |
+------+--------------------+----------+--------+--------------------------------------------------------+---------------+---------+-------------------------+-------+----------+----------------------------------------------------------------------------------------+
|    1 | PRIMARY            | nation   | ALL    | PRIMARY                                                | NULL          | NULL    | NULL                    |    25 |   100.00 | Using where; Using temporary; Using filesort                                           |
|    1 | PRIMARY            | supplier | ref    | PRIMARY,i_s_nationkey                                  | i_s_nationkey | 5       | dbt3.nation.n_nationkey | 12000 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan                     |
|    1 | PRIMARY            | l1       | ref    | PRIMARY,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | i_l_suppkey   | 5       | dbt3.supplier.s_suppkey |   599 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | orders   | eq_ref | PRIMARY                                                | PRIMARY       | 4       | dbt3.l1.l_orderkey      |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan               |
|    3 | DEPENDENT SUBQUERY | l3       | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity             | PRIMARY       | 4       | dbt3.l1.l_orderkey      |     3 |   100.00 | Using where                                                                            |
|    2 | DEPENDENT SUBQUERY | l2       | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity             | PRIMARY       | 4       | dbt3.l1.l_orderkey      |     3 |   100.00 | Using where                                                                            |
+------+--------------------+----------+--------+--------------------------------------------------------+---------------+---------+-------------------------+-------+----------+----------------------------------------------------------------------------------------+
--- Time elapsed ---
242



===== 21_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 273788496 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'ALGERIA'
group by
	s_name
order by
	numwait desc,
	s_name
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------------+----------+--------+--------------------------------------------------------+---------------+---------+-------------------------+-------+----------+----------------------------------------------------------------------------------------+
| id   | select_type        | table    | type   | possible_keys                                          | key           | key_len | ref                     | rows  | filtered | Extra                                                                                  |
+------+--------------------+----------+--------+--------------------------------------------------------+---------------+---------+-------------------------+-------+----------+----------------------------------------------------------------------------------------+
|    1 | PRIMARY            | nation   | ALL    | PRIMARY                                                | NULL          | NULL    | NULL                    |    25 |   100.00 | Using where; Using temporary; Using filesort                                           |
|    1 | PRIMARY            | supplier | ref    | PRIMARY,i_s_nationkey                                  | i_s_nationkey | 5       | dbt3.nation.n_nationkey | 12000 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan                     |
|    1 | PRIMARY            | l1       | ref    | PRIMARY,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | i_l_suppkey   | 5       | dbt3.supplier.s_suppkey |   599 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | orders   | eq_ref | PRIMARY                                                | PRIMARY       | 4       | dbt3.l1.l_orderkey      |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan               |
|    3 | DEPENDENT SUBQUERY | l3       | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity             | PRIMARY       | 4       | dbt3.l1.l_orderkey      |     3 |   100.00 | Using where                                                                            |
|    2 | DEPENDENT SUBQUERY | l2       | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity             | PRIMARY       | 4       | dbt3.l1.l_orderkey      |     3 |   100.00 | Using where                                                                            |
+------+--------------------+----------+--------+--------------------------------------------------------+---------------+---------+-------------------------+-------+----------+----------------------------------------------------------------------------------------+
--- Time elapsed ---
235



===== 21_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 273788496 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	s_name,
	count(*) as numwait
from
	supplier,
	lineitem l1,
	orders,
	nation
where
	s_suppkey = l1.l_suppkey
	and o_orderkey = l1.l_orderkey
	and o_orderstatus = 'F'
	and l1.l_receiptdate > l1.l_commitdate
	and exists (
		select
			*
		from
			lineitem l2
		where
			l2.l_orderkey = l1.l_orderkey
			and l2.l_suppkey <> l1.l_suppkey
	)
	and not exists (
		select
			*
		from
			lineitem l3
		where
			l3.l_orderkey = l1.l_orderkey
			and l3.l_suppkey <> l1.l_suppkey
			and l3.l_receiptdate > l3.l_commitdate
	)
	and s_nationkey = n_nationkey
	and n_name = 'ALGERIA'
group by
	s_name
order by
	numwait desc,
	s_name
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------------+----------+--------+--------------------------------------------------------+---------------+---------+-------------------------+-------+----------+----------------------------------------------------------------------------------------+
| id   | select_type        | table    | type   | possible_keys                                          | key           | key_len | ref                     | rows  | filtered | Extra                                                                                  |
+------+--------------------+----------+--------+--------------------------------------------------------+---------------+---------+-------------------------+-------+----------+----------------------------------------------------------------------------------------+
|    1 | PRIMARY            | nation   | ALL    | PRIMARY                                                | NULL          | NULL    | NULL                    |    25 |   100.00 | Using where; Using temporary; Using filesort                                           |
|    1 | PRIMARY            | supplier | ref    | PRIMARY,i_s_nationkey                                  | i_s_nationkey | 5       | dbt3.nation.n_nationkey | 12000 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan                     |
|    1 | PRIMARY            | l1       | ref    | PRIMARY,i_l_suppkey,i_l_orderkey,i_l_orderkey_quantity | i_l_suppkey   | 5       | dbt3.supplier.s_suppkey |   599 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | orders   | eq_ref | PRIMARY                                                | PRIMARY       | 4       | dbt3.l1.l_orderkey      |     1 |   100.00 | Using where; Using join buffer (incremental, BKA join); Key-ordered scan               |
|    3 | DEPENDENT SUBQUERY | l3       | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity             | PRIMARY       | 4       | dbt3.l1.l_orderkey      |     3 |   100.00 | Using where                                                                            |
|    2 | DEPENDENT SUBQUERY | l2       | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity             | PRIMARY       | 4       | dbt3.l1.l_orderkey      |     3 |   100.00 | Using where                                                                            |
+------+--------------------+----------+--------+--------------------------------------------------------+---------------+---------+-------------------------+-------+----------+----------------------------------------------------------------------------------------+
--- Time elapsed ---
233



===== 22_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 1268722672 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substr(c_phone, 1, 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substr(c_phone, 1, 2) in
				('32', '27', '15', '26', '33', '17', '34')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substr(c_phone, 1, 2) in
						('32', '27', '15', '26', '33', '17', '34')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as vip
group by
	cntrycode
order by
	cntrycode;
COMMIT;

--- Explain result ---
+------+--------------------+----------+------+---------------+-------------+---------+-------------------------+---------+----------+----------------------------------------------+
| id   | select_type        | table    | type | possible_keys | key         | key_len | ref                     | rows    | filtered | Extra                                        |
+------+--------------------+----------+------+---------------+-------------+---------+-------------------------+---------+----------+----------------------------------------------+
|    1 | SIMPLE             | customer | ALL  | NULL          | NULL        | NULL    | NULL                    | 4500000 |   100.00 | Using where; Using temporary; Using filesort |
|    4 | DEPENDENT SUBQUERY | orders   | ref  | i_o_custkey   | i_o_custkey | 5       | dbt3.customer.c_custkey |      15 |   100.00 | Using index                                  |
|    3 | SUBQUERY           | customer | ALL  | NULL          | NULL        | NULL    | NULL                    | 4500000 |   100.00 | Using where                                  |
+------+--------------------+----------+------+---------------+-------------+---------+-------------------------+---------+----------+----------------------------------------------+
--- Time elapsed ---
14



===== 22_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 1268722672 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substr(c_phone, 1, 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substr(c_phone, 1, 2) in
				('32', '27', '15', '26', '33', '17', '34')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substr(c_phone, 1, 2) in
						('32', '27', '15', '26', '33', '17', '34')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as vip
group by
	cntrycode
order by
	cntrycode;
COMMIT;

--- Explain result ---
+------+--------------------+----------+------+---------------+-------------+---------+-------------------------+---------+----------+----------------------------------------------+
| id   | select_type        | table    | type | possible_keys | key         | key_len | ref                     | rows    | filtered | Extra                                        |
+------+--------------------+----------+------+---------------+-------------+---------+-------------------------+---------+----------+----------------------------------------------+
|    1 | SIMPLE             | customer | ALL  | NULL          | NULL        | NULL    | NULL                    | 4500000 |   100.00 | Using where; Using temporary; Using filesort |
|    4 | DEPENDENT SUBQUERY | orders   | ref  | i_o_custkey   | i_o_custkey | 5       | dbt3.customer.c_custkey |      15 |   100.00 | Using index                                  |
|    3 | SUBQUERY           | customer | ALL  | NULL          | NULL        | NULL    | NULL                    | 4500000 |   100.00 | Using where                                  |
+------+--------------------+----------+------+---------------+-------------+---------+-------------------------+---------+----------+----------------------------------------------+
--- Time elapsed ---
14



===== 22_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 1268722672 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	cntrycode,
	count(*) as numcust,
	sum(c_acctbal) as totacctbal
from
	(
		select
			substr(c_phone, 1, 2) as cntrycode,
			c_acctbal
		from
			customer
		where
			substr(c_phone, 1, 2) in
				('32', '27', '15', '26', '33', '17', '34')
			and c_acctbal > (
				select
					avg(c_acctbal)
				from
					customer
				where
					c_acctbal > 0.00
					and substr(c_phone, 1, 2) in
						('32', '27', '15', '26', '33', '17', '34')
			)
			and not exists (
				select
					*
				from
					orders
				where
					o_custkey = c_custkey
			)
	) as vip
group by
	cntrycode
order by
	cntrycode;
COMMIT;

--- Explain result ---
+------+--------------------+----------+------+---------------+-------------+---------+-------------------------+---------+----------+----------------------------------------------+
| id   | select_type        | table    | type | possible_keys | key         | key_len | ref                     | rows    | filtered | Extra                                        |
+------+--------------------+----------+------+---------------+-------------+---------+-------------------------+---------+----------+----------------------------------------------+
|    1 | SIMPLE             | customer | ALL  | NULL          | NULL        | NULL    | NULL                    | 4500000 |   100.00 | Using where; Using temporary; Using filesort |
|    4 | DEPENDENT SUBQUERY | orders   | ref  | i_o_custkey   | i_o_custkey | 5       | dbt3.customer.c_custkey |      15 |   100.00 | Using index                                  |
|    3 | SUBQUERY           | customer | ALL  | NULL          | NULL        | NULL    | NULL                    | 4500000 |   100.00 | Using where                                  |
+------+--------------------+----------+------+---------------+-------------+---------+-------------------------+---------+----------+----------------------------------------------+
--- Time elapsed ---
13



===== 18_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 1583953264 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 313
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------+-------------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type  | table       | type   | possible_keys                              | key                   | key_len | ref                    | rows      | filtered | Extra                                                |
+------+--------------+-------------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
|    1 | PRIMARY      | orders      | ALL    | PRIMARY,i_o_custkey                        | NULL                  | NULL    | NULL                   |  45000000 |   100.00 | Using where; Using temporary; Using filesort         |
|    1 | PRIMARY      | <subquery2> | eq_ref | distinct_key                               | distinct_key          | 4       | dbt3.orders.o_orderkey |         1 |   100.00 |                                                      |
|    1 | PRIMARY      | customer    | eq_ref | PRIMARY                                    | PRIMARY               | 4       | dbt3.orders.o_custkey  |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
|    1 | PRIMARY      | lineitem    | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey_quantity | 4       | dbt3.orders.o_orderkey |         3 |   100.00 | Using index                                          |
|    2 | MATERIALIZED | lineitem    | index  | NULL                                       | PRIMARY               | 8       | NULL                   | 179998372 |   100.00 |                                                      |
+------+--------------+-------------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
196



===== 18_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 1583953264 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 313
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------+-------------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type  | table       | type   | possible_keys                              | key                   | key_len | ref                    | rows      | filtered | Extra                                                |
+------+--------------+-------------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
|    1 | PRIMARY      | orders      | ALL    | PRIMARY,i_o_custkey                        | NULL                  | NULL    | NULL                   |  45000000 |   100.00 | Using where; Using temporary; Using filesort         |
|    1 | PRIMARY      | <subquery2> | eq_ref | distinct_key                               | distinct_key          | 4       | dbt3.orders.o_orderkey |         1 |   100.00 |                                                      |
|    1 | PRIMARY      | customer    | eq_ref | PRIMARY                                    | PRIMARY               | 4       | dbt3.orders.o_custkey  |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
|    1 | PRIMARY      | lineitem    | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey_quantity | 4       | dbt3.orders.o_orderkey |         3 |   100.00 | Using index                                          |
|    2 | MATERIALIZED | lineitem    | index  | NULL                                       | PRIMARY               | 8       | NULL                   | 179998372 |   100.00 |                                                      |
+------+--------------+-------------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
204



===== 18_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 1583953264 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice,
	sum(l_quantity)
from
	customer,
	orders,
	lineitem
where
	o_orderkey in (
		select
			l_orderkey
		from
			lineitem
		group by
			l_orderkey having
				sum(l_quantity) > 313
	)
	and c_custkey = o_custkey
	and o_orderkey = l_orderkey
group by
	c_name,
	c_custkey,
	o_orderkey,
	o_orderdate,
	o_totalprice
order by
	o_totalprice desc,
	o_orderdate
LIMIT 100;
COMMIT;

--- Explain result ---
+------+--------------+-------------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
| id   | select_type  | table       | type   | possible_keys                              | key                   | key_len | ref                    | rows      | filtered | Extra                                                |
+------+--------------+-------------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
|    1 | PRIMARY      | orders      | ALL    | PRIMARY,i_o_custkey                        | NULL                  | NULL    | NULL                   |  45000000 |   100.00 | Using where; Using temporary; Using filesort         |
|    1 | PRIMARY      | <subquery2> | eq_ref | distinct_key                               | distinct_key          | 4       | dbt3.orders.o_orderkey |         1 |   100.00 |                                                      |
|    1 | PRIMARY      | customer    | eq_ref | PRIMARY                                    | PRIMARY               | 4       | dbt3.orders.o_custkey  |         1 |   100.00 | Using join buffer (flat, BKA join); Key-ordered scan |
|    1 | PRIMARY      | lineitem    | ref    | PRIMARY,i_l_orderkey,i_l_orderkey_quantity | i_l_orderkey_quantity | 4       | dbt3.orders.o_orderkey |         3 |   100.00 | Using index                                          |
|    2 | MATERIALIZED | lineitem    | index  | NULL                                       | PRIMARY               | 8       | NULL                   | 179998372 |   100.00 |                                                      |
+------+--------------+-------------+--------+--------------------------------------------+-----------------------+---------+------------------------+-----------+----------+------------------------------------------------------+
--- Time elapsed ---
202



===== 20_explain.sql Run No: 1 =====
STARTUP_PARAMS: 


-- using 3573821616 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	s_name,
	s_address
from
	supplier,
	nation
where
	s_suppkey in (
		select
			distinct (ps_suppkey)
		from
			partsupp,
			part
		where
			ps_partkey=p_partkey
			and p_name like 'spring%'
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= '1996-01-01'
					and l_shipdate < date_ADD('1996-01-01',interval 1 year)
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'KENYA'
order by
	s_name;
COMMIT;

--- Explain result ---
+------+--------------------+-------------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+---------+----------+--------------------------------------------------------------------+
| id   | select_type        | table       | type   | possible_keys                                            | key                 | key_len | ref                                               | rows    | filtered | Extra                                                              |
+------+--------------------+-------------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+---------+----------+--------------------------------------------------------------------+
|    1 | PRIMARY            | nation      | ALL    | PRIMARY                                                  | NULL                | NULL    | NULL                                              |      25 |   100.00 | Using where; Using temporary; Using filesort                       |
|    1 | PRIMARY            | supplier    | ref    | PRIMARY,i_s_nationkey                                    | i_s_nationkey       | 5       | dbt3.nation.n_nationkey                           |   12000 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | <subquery2> | eq_ref | distinct_key                                             | distinct_key        | 4       | func                                              |       1 |   100.00 |                                                                    |
|    2 | MATERIALIZED       | part        | ALL    | PRIMARY                                                  | NULL                | NULL    | NULL                                              | 6000000 |   100.00 | Using where                                                        |
|    2 | MATERIALIZED       | partsupp    | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                        | PRIMARY             | 4       | dbt3.part.p_partkey                               |       4 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan  |
|    3 | DEPENDENT SUBQUERY | lineitem    | ref    | i_l_shipdate,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey | i_l_suppkey_partkey | 10      | dbt3.partsupp.ps_partkey,dbt3.partsupp.ps_suppkey |       7 |   100.00 | Using where                                                        |
+------+--------------------+-------------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+---------+----------+--------------------------------------------------------------------+
--- Time elapsed ---
5505



===== 20_explain.sql Run No: 2 =====
STARTUP_PARAMS: 


-- using 3573821616 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	s_name,
	s_address
from
	supplier,
	nation
where
	s_suppkey in (
		select
			distinct (ps_suppkey)
		from
			partsupp,
			part
		where
			ps_partkey=p_partkey
			and p_name like 'spring%'
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= '1996-01-01'
					and l_shipdate < date_ADD('1996-01-01',interval 1 year)
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'KENYA'
order by
	s_name;
COMMIT;

--- Explain result ---
+------+--------------------+-------------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+---------+----------+--------------------------------------------------------------------+
| id   | select_type        | table       | type   | possible_keys                                            | key                 | key_len | ref                                               | rows    | filtered | Extra                                                              |
+------+--------------------+-------------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+---------+----------+--------------------------------------------------------------------+
|    1 | PRIMARY            | nation      | ALL    | PRIMARY                                                  | NULL                | NULL    | NULL                                              |      25 |   100.00 | Using where; Using temporary; Using filesort                       |
|    1 | PRIMARY            | supplier    | ref    | PRIMARY,i_s_nationkey                                    | i_s_nationkey       | 5       | dbt3.nation.n_nationkey                           |   12000 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | <subquery2> | eq_ref | distinct_key                                             | distinct_key        | 4       | func                                              |       1 |   100.00 |                                                                    |
|    2 | MATERIALIZED       | part        | ALL    | PRIMARY                                                  | NULL                | NULL    | NULL                                              | 6000000 |   100.00 | Using where                                                        |
|    2 | MATERIALIZED       | partsupp    | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                        | PRIMARY             | 4       | dbt3.part.p_partkey                               |       4 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan  |
|    3 | DEPENDENT SUBQUERY | lineitem    | ref    | i_l_shipdate,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey | i_l_suppkey_partkey | 10      | dbt3.partsupp.ps_partkey,dbt3.partsupp.ps_suppkey |       7 |   100.00 | Using where                                                        |
+------+--------------------+-------------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+---------+----------+--------------------------------------------------------------------+
--- Time elapsed ---
5524



===== 20_explain.sql Run No: 3 =====
STARTUP_PARAMS: 


-- using 3573821616 as a seed to the RNG
BEGIN;

EXPLAIN EXTENDED


select
	s_name,
	s_address
from
	supplier,
	nation
where
	s_suppkey in (
		select
			distinct (ps_suppkey)
		from
			partsupp,
			part
		where
			ps_partkey=p_partkey
			and p_name like 'spring%'
			and ps_availqty > (
				select
					0.5 * sum(l_quantity)
				from
					lineitem
				where
					l_partkey = ps_partkey
					and l_suppkey = ps_suppkey
					and l_shipdate >= '1996-01-01'
					and l_shipdate < date_ADD('1996-01-01',interval 1 year)
			)
	)
	and s_nationkey = n_nationkey
	and n_name = 'KENYA'
order by
	s_name;
COMMIT;

--- Explain result ---
+------+--------------------+-------------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+---------+----------+--------------------------------------------------------------------+
| id   | select_type        | table       | type   | possible_keys                                            | key                 | key_len | ref                                               | rows    | filtered | Extra                                                              |
+------+--------------------+-------------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+---------+----------+--------------------------------------------------------------------+
|    1 | PRIMARY            | nation      | ALL    | PRIMARY                                                  | NULL                | NULL    | NULL                                              |      25 |   100.00 | Using where; Using temporary; Using filesort                       |
|    1 | PRIMARY            | supplier    | ref    | PRIMARY,i_s_nationkey                                    | i_s_nationkey       | 5       | dbt3.nation.n_nationkey                           |   12000 |   100.00 | Using join buffer (flat, BKA join); Key-ordered Rowid-ordered scan |
|    1 | PRIMARY            | <subquery2> | eq_ref | distinct_key                                             | distinct_key        | 4       | func                                              |       1 |   100.00 |                                                                    |
|    2 | MATERIALIZED       | part        | ALL    | PRIMARY                                                  | NULL                | NULL    | NULL                                              | 6000000 |   100.00 | Using where                                                        |
|    2 | MATERIALIZED       | partsupp    | ref    | PRIMARY,i_ps_partkey,i_ps_suppkey                        | PRIMARY             | 4       | dbt3.part.p_partkey                               |       4 |   100.00 | Using where; Using join buffer (flat, BKA join); Key-ordered scan  |
|    3 | DEPENDENT SUBQUERY | lineitem    | ref    | i_l_shipdate,i_l_suppkey_partkey,i_l_partkey,i_l_suppkey | i_l_suppkey_partkey | 10      | dbt3.partsupp.ps_partkey,dbt3.partsupp.ps_suppkey |       7 |   100.00 | Using where                                                        |
+------+--------------------+-------------+--------+----------------------------------------------------------+---------------------+---------+---------------------------------------------------+---------+----------+--------------------------------------------------------------------+
--- Time elapsed ---
5512
